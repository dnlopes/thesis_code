namespace java util.thrift


enum CheckTypeRequest {
    UNIQUE,
    FOREIGN_KEY,
    REQUEST_ID,
    APPLY_DELTA
}

struct ThriftCheckRequest
{
    1: required string requestId;
    2: required list<ThriftCheckEntry> request;
}

struct ThriftCheckResponse
{
    1: required string responseId;
    2: required bool success;
    3: list<ThriftCheckResult> result;
}

struct ThriftCheckResult {
    1: required i32 id;
    2: required bool success;
    3: string resquestedValue;
    4: string fieldName;

}

struct ThriftCheckEntry {
    1: required CheckTypeRequest type;
    2: required i32 id;
    3: required string fieldName;
    4: required string tableName;
    5: string value;
}

struct ThriftOperation {
 1: required i64 txnId;
 2: required list<string> operations;
}

service ReplicatorRPC {
 bool commitOperation(1:ThriftOperation  op);
 bool commitOperationSync(1:ThriftOperation  op);
 oneway void commitOperationAsync(1:ThriftOperation op);
}

service CoordinatorRPC
{

    ThriftCheckResponse checkInvariants(1:ThriftCheckRequest checkRequest);
}