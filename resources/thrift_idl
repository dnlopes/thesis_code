namespace java util.thrift


enum CheckInvariantType {
    UNIQUE,
    FOREIGN_KEY,
    GREATHER_THAN,
    LESSER_THAN,
    DELETE_VALUE,
    DELTA,
    REQUEST_VALUE
}


enum MessageType {
 COMMIT = 1,
 REQUEST_TXN = 2,
 VALIDATE = 3,
}

struct ThriftCheckRequest
{
    1: required i32 requestId;
    2: required list<ThriftCheckEntry> request;
}

struct ThriftCheckResponse
{
    1: required i32 requestId;
    2: required bool success;
    3: list<ThriftCheckResult> result;
}

struct ThriftCheckResult {
    1: required i32 id;
    2: required bool success;
    3: string resquestedValue;
}

struct ThriftCheckEntry {
    1: required CheckInvariantType type;
    2: required i32 id;
    3: required string fieldName;
    4: required string tableName;
    5: string value;
    6: string resquestedValue;
    7: bool success; // not using for now
}

struct ThriftOperation {
 1: required i64 txnId;
 2: required list<string> operations;
}

service ReplicatorRPC {
 bool commitOperation(1:ThriftOperation  op);
 bool commitOperationSync(1:ThriftOperation  op);
 oneway void commitOperationAsync(1:ThriftOperation op);
}

service CoordinatorRPC
{

    ThriftCheckResponse checkInvariants(1:ThriftCheckRequest checkRequest);
}